# 键盘控制功能使用指南

## 概述

本项目的main程序现在支持键盘控制功能，允许用户在程序运行时通过按键来控制机器人的行为。

## 功能特性

- **非阻塞输入**: 键盘输入不会阻塞主循环的执行
- **实时响应**: 按键可以立即触发相应的功能
- **可扩展**: 可以轻松添加新的按键功能

## 支持的按键

| 按键 | 功能 | 描述 |
|------|------|------|
| `SPACE` | 切换零动作调试模式 | 启用/禁用将动作设置为零的调试功能 |
| `q` | 退出程序 | 安全退出程序 |
| `h` | 显示帮助 | 显示所有可用的按键功能 |

## 使用方法

### 1. 编译程序

使用项目提供的构建脚本：

```bash
./build.sh
```

### 2. 运行程序

```bash
./Lite_motion
```

### 3. 使用键盘控制

程序启动后，你可以：

- 按 `SPACE` 键来切换零动作调试模式
  - 当启用时，神经网络输出的动作会被设置为零
  - 再次按 `SPACE` 键可以禁用此模式
- 按 `h` 键查看帮助信息
- 按 `q` 键退出程序

## 技术实现

### 键盘控制器类

`KeyboardController` 类提供了以下功能：

- **初始化**: 设置终端为非阻塞模式
- **回调注册**: 为特定按键注册回调函数
- **输入检测**: 非阻塞地检测键盘输入
- **终端恢复**: 程序退出时恢复终端设置

### 集成方式

键盘控制器在主循环中被调用：

```cpp
while(1){
    // Process keyboard input
    keyboard_controller->ProcessKeyInput();
    
    // ... 其他主循环逻辑
}
```

## 扩展新功能

要添加新的按键功能，需要：

1. 定义回调函数：
```cpp
void OnNewKeyPressed() {
    // 实现新功能
    std::cout << "New key pressed!" << std::endl;
}
```

2. 注册回调函数：
```cpp
keyboard_controller->RegisterKeyCallback('n', OnNewKeyPressed);
```

3. 更新帮助信息（可选）

## 测试

可以使用测试程序验证键盘控制器功能：

```bash
./test_keyboard_controller
```

## 注意事项

- 键盘控制功能仅在Linux系统上测试过
- 程序需要在终端中运行才能接收键盘输入
- 某些终端模拟器可能不支持非阻塞输入模式

## 故障排除

如果键盘控制不工作：

1. 确保程序在终端中运行
2. 检查终端是否支持非阻塞输入
3. 尝试在不同的终端模拟器中运行
4. 查看程序启动时的初始化消息 